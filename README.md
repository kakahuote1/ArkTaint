<div align="center">

# ğŸ›¡ï¸ ArkTaint

**é¢å‘ HarmonyOS (ArkTS) çš„å¼€ç®±å³ç”¨é™æ€æ±¡ç‚¹åˆ†æå¼•æ“**

[![License](https://img.shields.io/badge/license-Apache%202.0-blue.svg)](LICENSE)
[![TypeScript](https://img.shields.io/badge/language-TypeScript-3178C6.svg)](https://www.typescriptlang.org/)
[![HarmonyOS](https://img.shields.io/badge/platform-HarmonyOS-black)](https://developer.huawei.com/consumer/cn/harmonyos)
[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](CONTRIBUTING.md)

[æ ¸å¿ƒç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§) â€¢ [æ¶æ„è®¾è®¡](#-æ¶æ„æ¦‚è§ˆ) â€¢ [è§„åˆ™é…ç½®èŒƒä¾‹](#-è§„åˆ™é…ç½®èŒƒä¾‹-configuration-examples) â€¢ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢ [æµ‹è¯•ä¸åŸºå‡†](#-æµ‹è¯•ä¸åŸºå‡†)
</div>

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

**ArkTaint** æ˜¯ä¸€ä¸ªä¸“ä¸º **HarmonyOS (ArkTS)** åŸç”Ÿåº”ç”¨ç”Ÿæ€è®¾è®¡çš„ä¸‹ä¸€ä»£é™æ€æ±¡ç‚¹åˆ†æï¼ˆStatic Taint Analysisï¼‰æ¡†æ¶ã€‚

å®ƒæ„å»ºåœ¨æ·±åº¦ç¨‹åºåˆ†æåº•åº§ [Arkanalyzer](https://gitcode.net/openharmony-sig/arkanalyzer) ç”Ÿæˆçš„æŒ‡é’ˆåˆ†é…å›¾ï¼ˆPAGï¼‰åŸºç¡€ä¹‹ä¸Šï¼Œæ—¨åœ¨å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘è€…è‡ªåŠ¨å‘ç°éšç§æ³„éœ²ã€SQL æ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ç­‰å…³é”®æ•°æ®æµå®‰å…¨é—®é¢˜ã€‚

**ArkTaint çš„ç»ˆæè®¾è®¡ç›®æ ‡**ï¼šå¯¹ ArkTS é¡¹ç›®è½»æ˜“æ‰§è¡Œæ±¡ç‚¹åˆ†æã€‚é€šè¿‡**é›¶ä»£ç æ¥å…¥**ä¸**å•å‘½ä»¤æ‰§è¡Œ**è®¾è®¡ï¼Œä½¿ç”¨è€…åªéœ€æä¾›é¡¹ç›®è·¯å¾„ä¸è‡ªå®šä¹‰è§„åˆ™é…ç½®ï¼ˆå¯é€‰ï¼‰ï¼Œå³å¯ä¸€é”®è¾“å‡ºæ¸…æ™°çš„æ¼æ´è¯†åˆ«æŠ¥å‘Šï¼Œ**å…¨ç¨‹æ— éœ€ä¿®æ”¹å¼•æ“æ ¸å¿ƒæºç **ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸš€ å¼€ç®±å³ç”¨ (Zero-Code Integration)**
  - **ä¸€é”®åˆ†æ**ï¼šé€šè¿‡ CLI å•å‘½ä»¤äº¤äº’è‡ªåŠ¨å®Œæˆé¡¹ç›®å·¥ç¨‹è§£æã€å…¥å£æ¢æµ‹ã€è§„åˆ™æ ¡éªŒä¸æµå‘è¿½è¸ªã€‚
  - **è‡ªåŠ¨è§„åˆ™åˆ†å±‚æœºåˆ¶**ï¼šæ”¯æŒè§„åˆ™é…ç½®çš„çƒ­æ’æ‹”ä¸ä¼˜å…ˆçº§åˆå¹¶ (`default < framework < project < llm_candidate`)ï¼Œå³ä½¿åœ¨æä½é…ç½®å¼€é”€ä¸‹ï¼Œä¹Ÿæœ‰å†…ç½®å®‰å…¨è§„åˆ™åŒ…å®‰å…¨å…œåº•ã€‚
  - **é«˜è§£é‡Šæ€§æŠ¥å‘Š**ï¼šå¼•æ“äº§å‡ºæ ‡å‡†åŒ–çš„ `summary.md/json`ï¼Œä¸ä»…å±•ç¤ºæ±¡æŸ“é“¾æ¡çš„æº¯æºæ•°æ®ï¼Œè¿˜èƒ½æ˜ç¡®å®šä½å®‰å…¨è§„åˆ™å‘½ä¸­ç¼˜ç”±ä»¥åŠè§„é¿æç¤ºã€‚

- **ğŸ¯ æè‡´ç²¾åº¦çš„é€šç”¨åº•åº§ (Precision & Capability)**
  - **è‡ªé€‚åº”ä¸Šä¸‹æ–‡æ•æ„Ÿ (Adaptive k-CFA)**ï¼šæ”¯æŒæŒ‰æ–¹æ³•çƒ­ç‚¹è‡ªåŠ¨é™ç»´æˆ–å‡ç»´çš„åŠ¨æ€ context-sensitive æ§åˆ¶æµåˆ†æï¼ˆé»˜è®¤ k=1ï¼‰ã€‚
  - **æ·±åº¦è¯­è¨€ç‰¹æ€§å»ºæ¨¡**ï¼šå®Œæ•´æ”¯æŒå­—æ®µæ•æ„Ÿï¼ˆField-Sensitiveï¼Œæ¶µç›–åµŒå¥—å¯¹è±¡å’Œè§£æ„ï¼‰ã€å®¹å™¨é«˜ç²¾å»ºæ¨¡ï¼ˆMap/Set/List/Arrayçš„å¢åˆ æ”¹æŸ¥æµè½¬ï¼‰ï¼Œå’Œå¤æ‚çš„å¼‚æ­¥ä¸äº‹ä»¶æµã€‚
  - **è¾¹ç¼˜ç‰¹æ€§ç²¾å‡†æ¡¥æ¥**ï¼šè‡ªåŠ¨ä¿®å¤å› åŒ¿åç®­å¤´å‡½æ•° `this` ä¸¢å¤±ã€`Reflect.call/apply` åå°„è°ƒç”¨ï¼Œä»¥åŠå˜é•¿å‚æ•°å±•å¼€ (`...args`) å¼•èµ·çš„æ§åˆ¶å›¾æ–­è£‚ã€‚



## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

ArkTaint åˆ†æç®¡çº¿å§‹ç»ˆåšæŒâ€œåˆ†æä¸‹æ²‰ä¸è§„åˆ™åŠ¨æ€æ³¨å…¥â€çš„è®¾è®¡åŸåˆ™ï¼š

| æ¨¡å—å±‚çº§          | æ ¸å¿ƒèŒè´£ä¸åˆ†å·¥                                                                                                                 |
| :---------------- | :----------------------------------------------------------------------------------------------------------------------------- |
| **Phase 1: åº•åº§** | `arkanalyzer`ï¼šæä¾›å‰ç«¯åŸºç¡€ç¼–è¯‘ä¸ä¸­é—´è¡¨ç¤ºã€‚è´Ÿè´£ç”Ÿæˆ ASTã€æ„å»ºç³»ç»Ÿè°ƒç”¨å›¾ (CallGraph) å¹¶è¾“å‡ºå®‰å…¨ä¸”ä¸å¯å˜çš„å±€éƒ¨æŒ‡é’ˆåˆ†é…è¡¨ (PAG)ã€‚ |
| **Phase 2: å¼•æ“** | `src/core`ï¼šæ ¸å¿ƒæ•°æ®æµå·¥ä½œæµå¼•æ“ä¸»ä½“ã€‚å…¨é‡æ¥ç®¡åŸºäº Worklist ç®—æ³•çš„æ±¡æŸ“è·Ÿè¸ªï¼Œå¹¶ç®¡ç†æ‰€æœ‰çš„ Transfer åˆæµåˆå¹¶ä¸æ¡ä»¶è®¡ç®—ã€‚         |
| **è§„åˆ™ä¸æ¥å£å±‚**  | `src/cli` ä¸ `rules/`ï¼šç»Ÿç®¡åº”ç”¨æ‰«æä¸æŠ¥å‘Šæ”¶é›†ã€‚é€šè¿‡åˆ†ç¦»çš„æ•°æ®é…ç½®ä½¿å¾—ç¬¬ä¸‰æ–¹äºŒæ¬¡ç ”å‘ä»…éœ€æ‹“å±•å¤–éƒ¨ JSON å³å¯ç”Ÿæ•ˆå…¨éƒ¨ç‰¹æ€§ã€‚        |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ› ï¸ å‰ç½®è¦æ±‚

- **Node.js**: `^18.15.0`
- **npm**: `^9.0.0`
- **TypeScript**: `^5.0.0`
- **ç³»ç»Ÿç¯å¢ƒ**: è·¨å¹³å°å…¼å®¹ (Windows / macOS / Linux)

### ğŸ“¦ å®‰è£…ä¸æ„å»º

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/YourOrg/ArkTaint.git
cd ArkTaint

# 2. å®‰è£…å·¥ç¨‹ä¸åˆ†æåº•å±‚ä¾èµ–
npm install

# 3. ç¼–è¯‘ ArkTaint TypeScript æºç 
npm run build
```

### ğŸ¯ ä¸€é”®åˆ†æç›®æ ‡é¡¹ç›®

ArkTaint æœ€å¤§çš„ç‰¹è‰²æ˜¯å¯ä»¥ç›´æ¥å¯¹æ¥ä½ çš„æµ‹è¯•é¡¹ç›®è¿›è¡Œé›¶ä»£ç ä¾µå…¥åˆ†æï¼š

```bash
# æ–¹å¼ Aï¼šè¿è¡Œ ArkTaint è‡ªå¸¦çš„å¿«é€Ÿæ¼”ç¤ºé¶åœºé¡¹ç›®
# æ¼”ç¤ºå°†åœ¨ tmp/analyze/demo_complex_calls/summary.md ä¸­ç”Ÿæˆåˆ†ææŠ¥å‘Š
npm run analyze:demo

# æ–¹å¼ Bï¼šé’ˆå¯¹æ‚¨æœ¬åœ°ç‹¬ç«‹çš„çœŸå®å·¥ç¨‹è¿›è¡Œæ±¡ç‚¹å…¨é‡æ¢æµ‹
# <repo-path> ä¼ å…¥å·¥ç¨‹æ ¹ç›®å½•è·¯å¾„å³å¯
node out/cli/analyze.js --repo <repo-path>
```

åˆ†æå®Œæˆåï¼Œæ‚¨å¯ä»¥åœ¨åŒç›®å½•æˆ– `--outputDir` æŒ‡å®šä½ç½®æŸ¥çœ‹ç»“æœæ–‡ä»¶ `summary.md` å’Œ `summary.json` ä»¥è·å–æœ€ç»ˆçš„æ¼æ´ç»Ÿè®¡ä¸è¿½æº¯é“¾è·¯ã€‚

## ğŸ’¡ è§„åˆ™é…ç½®èŒƒä¾‹ (Configuration Examples)

ArkTaint çš„ä¸€å¤§ç‰¹è‰²æ˜¯**è§„åˆ™é©±åŠ¨çš„é›¶ä»£ç æ¥å…¥**ï¼Œæ‰€æœ‰åˆ†æè¡Œä¸ºéƒ½èƒ½é€šè¿‡ç¼–å†™ JSON è§„åˆ™æ§åˆ¶ã€‚ä¸éœ€è¦ä¿®æ”¹åº•å±‚ä¼ æ’­å¼•æ“ï¼Œå³å¯æ”¯æŒå¤æ‚çš„ Transfer ä¼ æ’­è¯­ä¹‰ä¸ Sanitizer è¯¯æŠ¥å‡€åŒ–å®ˆå«ã€‚

### 1. ä¼ æ’­è§„åˆ™ (Transfer Rules)

Transfer è§„åˆ™ç”¨äºç²¾å‡†æ§åˆ¶æ±¡ç‚¹åœ¨ç‰¹å®šå‡½æ•°è°ƒç”¨å†…çš„èµ°å‘ï¼Œæ”¯æŒä»ç²¾ç¡®ç«¯ç‚¹ (`from`) ä¼ æ’­åˆ°ç²¾ç¡®ç«¯ç‚¹ (`to`)ã€‚

```json
{
  "transfers": [
    {
      "id": "transfer.example.push_to_array",
      "match": {
        "kind": "method_name_equals",
        "value": "push"
      },
      "from": "arg0",
      "to": "base"
    },
    {
      "id": "transfer.example.read_property",
      "match": {
        "kind": "method_name_equals",
        "value": "getData"
      },
      "from": "base",
      "to": "result"
    }
  ]
}
```

### 2. å‡€åŒ–å®ˆå«è§„åˆ™ (Sanitizer Guard Rules)

Sanitizer è§„åˆ™ç”¨äºæ¶ˆé™¤å·²çŸ¥å®‰å…¨è¿‡æ»¤å‡½æ•°å¼•èµ·çš„è¯¯æŠ¥ã€‚åœ¨ `sink` åˆ¤å®šå‰ï¼Œå¼•æ“ä¼šæ£€æŸ¥åŒå‡½æ•°å†…ã€åŒç›®æ ‡è·¯å¾„ä¸Šæ˜¯å¦å‘ç”Ÿè¿‡ `SanitizerRule` è®¾å®šçš„è°ƒç”¨ï¼Œè‹¥å‘½ä¸­åˆ™å®‰å…¨æŠ‘åˆ¶è¯¥æ¼æ´å‘Šè­¦ã€‚

```json
{
  "sanitizers": [
    {
      "id": "sanitizer.example.escape_html",
      "sanitizeTarget": "result",
      "sanitizeTargetRef": {
        "endpoint": "result"
      },
      "match": {
        "kind": "method_name_equals",
        "value": "EscapeHTML"
      }
    },
    {
      "id": "sanitizer.example.clean_inplace",
      "sanitizeTarget": "arg0",
      "sanitizeTargetRef": {
        "endpoint": "arg0"
      },
      "match": {
        "kind": "method_name_equals",
        "value": "CleanInPlace"
      }
    }
  ]
}
```

## ğŸ“Š æµ‹è¯•ä¸åŸºå‡† (Benchmark)

ArkTaint å…·æœ‰é¡¶å°–çš„å¼•æ“ç¨³å®šæ€§æŒ‡æ ‡å’ŒåŸºçº¿ä¿éšœæœºåˆ¶ï¼ˆä»¥ 2026-02-18 æ•°æ®åº¦é‡ï¼‰ï¼š

| éªŒè¯ç»´åº¦               | è¯„ä¼°ç»“æœ (ArkTaint å¯¹ç…§æƒ…å†µ) | å¤‡æ³¨è¯´æ˜                                                                                             |
| :--------------------- | :--------------------------- | :--------------------------------------------------------------------------------------------------- |
| **å…¨é‡æ•°æ®é›†ç”¨ä¾‹éªŒè¯** | **100.0%** (230/230, k=1)    | è¦†ç›–ä¸Šä¸‹æ–‡æ•æ„Ÿã€å­—æ®µæ•æ„Ÿç­‰ç»å¤§éƒ¨åˆ†é«˜çº§è¯­è¨€è¾¹ç•Œæƒ…å†µ                                                   |
| **ç«¯åˆ°ç«¯åˆ†ææ€§èƒ½**     | **æé€ŸåŸºå‡†å‘ˆç°**             | ç» Phase 6.5å¤šå…¥å£å¤ç”¨ä¸ Phase 6.6æ£€æµ‹ä¾§ç´¢å¼•åŒ–ï¼ˆå•é¡¹é™å¹…è¾¾ 88%~95%ï¼‰ï¼Œå®ç°å¤§è§„æ¨¡åœºæ™¯æ¯«ç§’çº§ç«¯åˆ°ç«¯å“åº” |
| **å‡†ç¡®ç‡ä¸å¯¹æ¯”è¡¨ç°**   | **FP=0, FN=0**               | å…¨é‡è¶…è¶Šå‰æœŸè¯¾é¢˜ç«å“ï¼ˆç²¾åº¦/æ€§èƒ½/æ˜“ç”¨æ€§/ç¨³å®šæ€§æŒ‡æ ‡å…¨é¢è¾¾æ ‡ï¼‰                                          |
| **æµ‹è¯•é—¨ç¦ä¸åè€åŒ–**   | **æ— ç¼æ”¯æŒæ³›åŒ–æ‹¦æˆª**         | å¼•å…¥ Metamorphic å˜å‹ç­‰ä»·é˜²è¿‡æ‹ŸåˆéªŒè¯æœºåˆ¶åŠçœŸå®å¼€æºç”¨ä¾‹è¿ç»­æ‰“ç‚¹                                      |

### è‡ªåŠ¨åŒ–åŸºçº¿éªŒè¯é›†æµ‹

è‹¥æ‚¨è¯•å›¾äºŒæ¬¡å¼€å‘æ ¸å¿ƒé€»è¾‘ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥æœ‰æ— å‡ºç°æ€§èƒ½æˆ–ç²¾æµ‹é€€åŒ–ï¼ˆå»ºè®®ä½œä¸ºæ‰€æœ‰ PR æäº¤å‰ç½®é¡¹ï¼‰ï¼š

```bash
npm run verify
```


## ğŸ“œ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº **Apache License 2.0** å¼€æºåè®®å‘å¸ƒã€‚è¯¦ç»†æ¡æ¬¾è¯·å‚é˜… [LICENSE](package.json) æ–‡ä»¶ç›¸å…³æ ‡å‡†çº¦å®šå£°æ˜ã€‚

## ğŸ“® è”ç³»æ–¹å¼

ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„æ‰€æœ‰ç–‘æƒ‘ç‚¹åŠå®‰å…¨æ¼æŠ¥ Bugï¼Œæ¬¢è¿å¼€ Issue æˆ–ä¸ç¤¾åŒº Maintainer æ²Ÿé€šæ¢è®¨ã€‚

---
<p align="center">Made with â¤ï¸ for Security Automation and HarmonyOS Ecosystem.</p>
